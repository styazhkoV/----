Title: КДП

Клиент -> SDBO UL: Запрос на создание открытие счёта
SDBO UL -> ESB : Запрос в IBSO на открытие счёта
ESB -> IBSO : Запрос полей регистрации в IBSO
IBSO -> ESB : Поля регистрации
ESB -> SDBO UL : Поля регистрации
IBSO -> SDBO UL: Форма регистрации
SDBO UL -> Клиент: Форма регистрации
Клиент -> SDBO UL: ИИН + номер телефона
SDBO UL -> ESB: ИИН / номер телефона

ESB -> ГБД ЮЛ : healthcheck (проверка сервиса)
ESB -> ГБД ЮЛ : check_token (проверяет сохранен ли токен в нашей БД)
ГБД ЮЛ -> ESB: "status,"token,public_key
ESB -> ГБД ЮЛ : ИИН / номер телефона
note: ```
{
"status": "VALID",
"token": "",   - токен КДП
"public_key": "" - публичный ключ КДП необходим для запроса egov.GetUniversalToken, а также некоторых других
}

```
IBSO -> ESB : запрос на проверку в ГБД ЮЛ
ESB -> ГБД ЮЛ : create_token запрос на создание токена
ESB -> ГБД ЮЛ : create_token запрос обновления номера в БМГ
note: Отличие запросов check_token, create_token, update_mcbd от srv/check_token, srv/create_token, srv/update_mcbd:

те, что без srv предназначены для вызова с мобилки и им необходимы JWT token, вторые можно вызывать с бэкенда
ГБД ЮЛ -> ESB: данные о Клиенте 
ESB -> IBSO : данные о Клиенте 
IBSO -> SDBO UL: результат проверки
SDBO UL -> Клиент : Проверка не пройдена❌ 

Клиент -> SDBO UL : Проверка пройдена  ✅
SDBO UL -> ESB: отправка данных проверки ГБД ЮЛ
ESB -> IBSO : Запись данных в БД IBSO 
SDBO UL -> ESB : Запрос на проверку в ГБД ЗАГС
ESB -> ГБД ЗАГС : ИИН
ГБД ЗАГС  -> ESB: данные ГБД ЗАГС
note: :{
формат запроса данных ГБД ЗАГС
}
ESB -> IBSO : Запись данных в БД IBSO 
IBSO -> ESB : запрос на проверку в ГБД РН
ESB -> ГБД РН : ИИН
note: :{
формат запроса данных ГБД РН
}
ГБД РН  -> ESB: по ИИН из ГБД РН
ESB -> IBSO : Запись данных в БД IBSO 
IBSO -> ESB : Запрос на проверку в Доходы ЮЛ
ESB -> Доходы ЮЛ : ИИН
ГБД РН  -> ESB: данные Доходы ЮЛ
note: :{
формат запроса данных Доходы ЮЛ
}
ESB -> IBSO : Запись данных в БД IBSO 
IBSO -> ESB : отправка данных карточки клиента
ESB -> SDBO UL : карточка клиента сформированна
SDBO UL -> Клиент: открытие счёта
Клиент -> SDBO UL: статус 200 счёт открыт...
SDBO UL -> ESB: статус 200
ESB -> IBSO : запрос на открытие счёта 
IBSO -> ESB : id клиента и номер счёта
ESB -> SDBO UL : id клиента и номер счёта
SDBO UL -> Клиент : сообщение об откртии счёта✅
```

<root>
  <request id="2DB1EE00-7048-643E-E064-3CFDFEF0B918" system="InFinIt" type="request" operation="unkReptr">
    <dateTime>2023-07-20T23:57:53</dateTime>
    <body>
      <doc>
          <customerId>6688</customerId>
          <unkRegNumber>2/821/0000/4077</unkRegNumber>
      </doc>
    </body>
  </request>
</root>

Выдержка из ТЗ:
*"При получении запроса по нарушению срока репатриации «unkReptr» СДБО находит по значению customerId клиента и по unkRegNumber соответствующий контракт где в поле «Нарушение срока репатриации» проставляет текущую дату."
Так, что это не само "уведомление о сроке репатр" а, это просто прилетает результат операции на БД или хрен его знает где на ИБСО, а операция должна без джобов выполняться на ИБСО*

Выдержка из ТЗ:
*" 1) На стороне ИБСО необходимо доработать операцию «РБК. Расчет срока репатриации (ежедневный)» (RBK_REPTR_CALC) ТБП «CONTR» в части отправки в СДБО информации о контрактах, вышедших на нарушение.
2) В операции «RBK_REPTR_CALC» добавить отправку данных по контрактам с нарушением срока репатриации наступающим в текущем дне (date_sr=sysdate) в СДБО согласно условию:"*

*Клиент-владелец контракта является действующим пользователем СДБО (z#contr.c_Client_Arr#client_Org=VW_CRIT_RBK_CORP_INFIN.ref3 and VW_CRIT_RBK_CORP_INFIN.REF6 = 2047879)
Имеет действующий контракт с присвоенным учетным номером (z#contr.C_NUMB_PASS_NEW is not null and z#contr.state_id in 'CONFIRM')
Дата истечения срока репатриации равна текущей дате (date_sr=sysdate)*

В итоге это задача состоит как я понял из 5 частей:

1) Переписать техническое задание с текущим пониманием как работатет доработка.
2) Доработать операцию  RBK_REPTR_CALC на ИС ИБСО
3) Реализовать на СДБО операцию в БД где: из входящего сообщения с ИБСО находит значение customerId клиента и по unkRegNumber соответствующий контракт где в поле «Нарушение срока репатриации» проставляет  записывает в БД текущую дату
4) Проброс СДБО <-> Шина
5) Сооздание поля на фронте в форме валютных конрактов
6) После этого,мы на СДБО имея дату для поля repatr делаем:
   цикл в условии которого будет текущая дата, который будет обходить фьючерсы каждый раз при авторизации, и если текущая дата = полю со значением даты репатриации по контракту , и по ним выводим алёрт

![Задача - Задание для выполнения.](https://jira.kazincombank.kz/secure/viewavatar?size=xsmall&avatarId=10318&avatarType=issuetype "Задача - Задание для выполнения.") [ES-543](https://jira.kazincombank.kz/browse/ES-543) **[ESB] Интеграция (проброс) посредством шины СБДО ЮЛ и ИБСО**

* **НА АНАЛИЗЕ**

![Подзадача - Подзадача запроса](https://jira.kazincombank.kz/secure/viewavatar?size=xsmall&avatarId=10316&avatarType=issuetype "Подзадача - Подзадача запроса") [DRKS-153](https://jira.kazincombank.kz/browse/DRKS-153) **[Backend] Реализовать на СДБО операцию записи даты просрочки в БД**

* **В РАБОТЕ**

4. Реализовать функционал проверки даты репатриации (на основании записи в БД с ИБСО) по валютным контрактам при авторизации пользователя
5. Реализовать функционал вывода уведомления при нарушении срока репатриации

[6. [DRKS-81] [Дизайн] Вёрстка дизайна модального окна - JIRA (kazincombank.kz)](https://jira.kazincombank.kz/browse/DRKS-81) модальное окно с алёртом
